#!/bin/bash
set -e

contains () {
    local e match="$1"
    shift
    for e; do [[ "$e" == "$match" ]] && return 0; done
    return 1
}

cols=()
vars=()

while [ $# -gt 0 ]; do
    case $1 in
        -c) cols+=($2) && shift 2;;
        -v) vars+=($2) && shift 2;;
        *)  break;;
    esac
done

[ -z $1 ] && echo "error: file not specified" >&2 && exit 1
file=$1
spec=()

for fld in $(cat $file | head -n 1 | tr ',' '\n'); do
    if contains $fld ${cols[@]}; then
        spec+=($fld)
    elif contains $fld ${vars[@]}; then
        spec+=("@$fld")
    else
        spec+=("@dummy${#spec[@]}")
    fi
done;

echo $(IFS=,; echo "${spec[*]}")